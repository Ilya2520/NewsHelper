# Проект "Новостной модуль на Symfony"

Этот проект представляет собой модуль новостей на PHP-фреймворке Symfony. Реализованы CRUD операции для новостных сущностей, REST API, сбор новостей из внешних RSS-лент.

Можно было бы добавить еще некоторый функционал, однако итак вышло объемно и по времени не хватило бы.

## Стэк

- Symfony 7
- PHP 8.2
- База данных PostgreSQL
- Redis
- Контейнеризация в Docker и Docker Compose


## Реализовано

- Rest Api (реализоваан весь требуемый функционал (поиск новостей за период, пагинация через query параметры), также дополнительно есть эндпоинты для категорий и для источников)
- Документация и ручное тестирование api в Swagger по эндпоинту http://localhost:8000/api/doc
- Админ панель EasyAdmin с полностью реализованным требуемым функционалом http://localhost:8000/admin
- Кеширование и инвалидация
- Консольная команда NewsParserCommand
- Логирование 

## Установка и запуск

1. Клонируйте репозиторий и перейдите в каталог проекта:
   ```bash
   git clone https://github.com/Ilya2520/NewsHelper.git
   cd NewsHelper
   ```
2. Запустите контейнеры Docker и зайдите в контейнер приложения:
   ```bash
   docker-compose up -d
   docker-compose exec -it symfony_app bash
   ```

3. Настройте файл .env, можно скопировать конфигурацию по умолчанию
    ```bash
   cp .env.test .env
    ```
4. Установите зависимости внутри контейнера:
    ```bash
   composer install
    ```
5. Запустите миграции для создания таблиц в базе данных:
    ```bash
   php bin/console doctrine:migrations:migrate
    ```
6. Запустите команду для сбора новостей:
    ```bash
   php bin/console app:parse-news [options]
    ```

## Команда для парсинга новостей

Команда `app:parse-news` предназначена для парсинга новостей из RSS-лент источников. Вы можете указать конкретный источник или несколько источников, а также ограничить количество новостей для парсинга.

### Синтаксис

```bash
php bin/console app:parse-news [options]
```
### Параметры

- `--source`   Указывает источник или источники новостей для парсинга. Вы можете указать один или несколько источников. Если параметр не задан, будут парсены все доступные источники. Если выбран advanced - настраиваемый парсинг и нужно указать дополнительные параметры

- `--limit` Ограничивает количество новостей, которые нужно спарсить с каждого источника. Если параметр не указан, будет парситься количетсво новостей по умолчанию.
- `--titleTag, --categoryTag --dateTag --categoryTag --linkTag --`
  Параметры передаваемые при настраиваемом парсинге с кастомного источника (--source='advanced')
- `--descriptionPattern`
  Параметр, использующийся как шаблон регулярного выражения, по которому ищется краткое описание новости на странице, если не было найдено в RSS ленте
- `--rssUrl --sourceName`
    Обязательные параметры при запуске настраиваемого парсера, url ленты и назввание источника соответственно.

### Примеры использования

1. **Парсинг новостей с одного источника (например, "RIA News")**  
   Парсит все доступные новости из источника "RIA News":
   ```bash
   php bin/console app:parse-news --source="ria"
   php bin/console app:parse-news --source="ria" --source="lenta"
   php bin/console app:parse-news --source="ria" --limit=5
   php bin/console app:parse-news
   php bin/console app:parse-news --source="advanced" --limit=1 --rssUrl=https://news.rambler.ru/rss/world/ --sourceName=Rambler
    ```
